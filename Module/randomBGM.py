import random, os, zipfile

class RandomBGM():
    def randomizeBGM(option, platform):
        if not platform == "PC":
            return ""
        if option == "Disabled":
            return ""
        
        KH2BGMList = [
            "music050.win32.scd",
            "music051.win32.scd",
            "music052.win32.scd",
            "music053.win32.scd",
            "music054.win32.scd",
            "music055.win32.scd",
            "music059.win32.scd",
            "music060.win32.scd",
            "music061.win32.scd",
            "music062.win32.scd",
            "music063.win32.scd",
            "music064.win32.scd",
            "music065.win32.scd",
            "music066.win32.scd",
            "music067.win32.scd",
            "music068.win32.scd",
            "music069.win32.scd",
            "music081.win32.scd",
            "music082.win32.scd",
            "music084.win32.scd",
            "music085.win32.scd",
            "music086.win32.scd",
            "music087.win32.scd",
            "music088.win32.scd",
            "music089.win32.scd",
            "music090.win32.scd",
            "music091.win32.scd",
            "music092.win32.scd",
            "music093.win32.scd",
            "music094.win32.scd",
            "music095.win32.scd",
            "music096.win32.scd",
            "music097.win32.scd",
            "music098.win32.scd",
            "music099.win32.scd",
            "music100.win32.scd",
            "music101.win32.scd",
            "music102.win32.scd",
            "music103.win32.scd",
            "music104.win32.scd",
            "music106.win32.scd",
            "music107.win32.scd",
            "music108.win32.scd",
            "music109.win32.scd",
            "music110.win32.scd",
            "music111.win32.scd",
            "music112.win32.scd",
            "music113.win32.scd",
            "music114.win32.scd",
            "music115.win32.scd",
            "music116.win32.scd",
            "music117.win32.scd",
            "music118.win32.scd",
            "music119.win32.scd",
            "music120.win32.scd",
            "music121.win32.scd",
            "music122.win32.scd",
            "music123.win32.scd",
            "music124.win32.scd",
            "music125.win32.scd",
            "music127.win32.scd",
            "music128.win32.scd",
            "music129.win32.scd",
            "music130.win32.scd",
            "music131.win32.scd",
            "music132.win32.scd",
            "music133.win32.scd",
            "music134.win32.scd",
            "music135.win32.scd",
            "music136.win32.scd",
            "music137.win32.scd",
            "music138.win32.scd",
            "music139.win32.scd",
            "music141.win32.scd",
            "music142.win32.scd",
            "music143.win32.scd",
            "music144.win32.scd",
            "music145.win32.scd",
            "music146.win32.scd",
            "music148.win32.scd",
            "music149.win32.scd",
            "music151.win32.scd",
            "music152.win32.scd",
            "music153.win32.scd",
            "music154.win32.scd",
            "music155.win32.scd",
            "music158.win32.scd",
            "music159.win32.scd",
            "music164.win32.scd",
            "music185.win32.scd",
            "music186.win32.scd",
            "music187.win32.scd",
            "music188.win32.scd",
            "music189.win32.scd",
            "music190.win32.scd",
            "music506.win32.scd",
            "music507.win32.scd",
            "music508.win32.scd",
            "music509.win32.scd",
            "music513.win32.scd",
            "music517.win32.scd",
            "music521.win32.scd",
            "music530.win32.scd",]
        BBSBGMList = [
            "bbs\\001sinde_f.win32.scd",
            "bbs\\002sinde_b.win32.scd",
            "bbs\\003nemure_f.win32.scd",
            "bbs\\004nemure_b.win32.scd",
            "bbs\\005syugyo_f.win32.scd",
            "bbs\\006syugyo_b.win32.scd",
            "bbs\\007shira_f.win32.scd",
            "bbs\\008shira_b.win32.scd",
            "bbs\\009raydi_f.win32.scd",
            "bbs\\010raydi_b.win32.scd",
            "bbs\\011distow_f.win32.scd",
            "bbs\\012distow_b.win32.scd",
            "bbs\\013never_f.win32.scd",
            "bbs\\014never_b.win32.scd",
            "bbs\\015herc_f.win32.scd",
            "bbs\\016herc_b.win32.scd",
            "bbs\\017riro_f.win32.scd",
            "bbs\\018riro_b.win32.scd",
            "bbs\\019iensid_f.win32.scd",
            "bbs\\020iensid_b.win32.scd",
            "bbs\\021kouya_f.win32.scd",
            "bbs\\022disice_f.win32.scd",
            "bbs\\023tsusin_f.win32.scd",
            "bbs\\030youki.win32.scd",
            "bbs\\031isamashi.win32.scd",
            "bbs\\032odayaka.win32.scd",
            "bbs\\033fuon.win32.scd",
            "bbs\\034kanasii.win32.scd",
            "bbs\\035kinpaku.win32.scd",
            "bbs\\036seisin.win32.scd",
            "bbs\\037yami.win32.scd",
            "bbs\\038ria_deai.win32.scd",
            "bbs\\040anba_b1.win32.scd",
            "bbs\\041anba_b2.win32.scd",
            "bbs\\042dis_b1.win32.scd",
            "bbs\\043dis_b2.win32.scd",
            "bbs\\044vanita_b.win32.scd",
            "bbs\\045anthem_b.win32.scd",
            "bbs\\046last_b1.win32.scd",
            "bbs\\047last_b2.win32.scd",
            "bbs\\048hanyo_b1.win32.scd",
            "bbs\\049hanyo_b2.win32.scd",
            "bbs\\050title.win32.scd",
            "bbs\\051worldmap.win32.scd",
            "bbs\\060tera.win32.scd",
            "bbs\\061aqua.win32.scd",
            "bbs\\062ven.win32.scd",
            "bbs\\063kairi1.win32.scd",
            "bbs\\066peet.win32.scd",
            "bbs\\067disvill.win32.scd",
            "bbs\\068zea.win32.scd",
            "bbs\\069braig.win32.scd",
            "bbs\\070key_l.win32.scd",
            "bbs\\071key_d.win32.scd",
            "bbs\\072key_l_d.win32.scd",
            "bbs\\073kizuna.win32.scd",
            "bbs\\074zack.win32.scd",
            "bbs\\100ice1_128.win32.scd",
            "bbs\\101ice1_132.win32.scd",
            "bbs\\102ice_2.win32.scd",
            "bbs\\103fruit.win32.scd",
            "bbs\\104dice.win32.scd",
            "bbs\\105poomini.win32.scd",
            "bbs\\106cartrace.win32.scd",
            "bbs\\107syugyo.win32.scd",
            "bbs\\108riro.win32.scd",
            "bbs\\109training.win32.scd",
            "bbs\\110han_bt1.win32.scd",
            "bbs\\111han_bt2.win32.scd",
            "bbs\\112rage_bt.win32.scd",
            "bbs\\113kh1tit.win32.scd",
            "bbs\\114raceview.win32.scd",
            "bbs\\115boss.win32.scd",
            "bbs\\116icon.win32.scd",
            "bbs\\117short_l2.win32.scd",
            "bbs\\118gumi.win32.scd",
            "bbs\\119desti.win32.scd",
            "bbs\\120hand.win32.scd",
            "bbs\\122nazono.win32.scd",
            "bbs\\123rev.win32.scd",
            "bbs\\124dp_amb.win32.scd",
            "bbs\\125yami_f.win32.scd",
            "bbs\\126yami_b.win32.scd",
            "bbs\\127Xeha_b.win32.scd",
            "bbs\\128Eraqu_b.win32.scd",
            "bbs\\129Pure_b.win32.scd",
            "bbs\\130Mons_b.win32.scd",
        ]
        KH1BGMList = [
            "kh1\\music097.win32.scd",
            "kh1\\music098.win32.scd",
            "kh1\\music099.win32.scd",
            "kh1\\music100.win32.scd",
            "kh1\\music101.win32.scd",
            "kh1\\music102.win32.scd",
            "kh1\\music103.win32.scd",
            "kh1\\music104.win32.scd",
            "kh1\\music105.win32.scd",
            "kh1\\music106.win32.scd",
            "kh1\\music107.win32.scd",
            "kh1\\music108.win32.scd",
            "kh1\\music109.win32.scd",
            "kh1\\music110.win32.scd",
            "kh1\\music111.win32.scd",
            "kh1\\music112.win32.scd",
            "kh1\\music113.win32.scd",
            "kh1\\music114.win32.scd",
            "kh1\\music115.win32.scd",
            "kh1\\music116.win32.scd",
            "kh1\\music117.win32.scd",
            "kh1\\music118.win32.scd",
            "kh1\\music119.win32.scd",
            "kh1\\music120.win32.scd",
            "kh1\\music121.win32.scd",
            "kh1\\music122.win32.scd",
            "kh1\\music123.win32.scd",
            "kh1\\music124.win32.scd",
            "kh1\\music125.win32.scd",
            "kh1\\music126.win32.scd",
            "kh1\\music127.win32.scd",
            "kh1\\music128.win32.scd",
            "kh1\\music129.win32.scd",
            "kh1\\music130.win32.scd",
            "kh1\\music131.win32.scd",
            "kh1\\music132.win32.scd",
            "kh1\\music137.win32.scd",
            "kh1\\music140.win32.scd",
            "kh1\\music141.win32.scd",
            "kh1\\music142.win32.scd",
            "kh1\\music143.win32.scd",
            "kh1\\music144.win32.scd",
            "kh1\\music145.win32.scd",
            "kh1\\music146.win32.scd",
            "kh1\\music147.win32.scd",
            "kh1\\music148.win32.scd",
            "kh1\\music149.win32.scd",
            "kh1\\music150.win32.scd",
            "kh1\\music151.win32.scd",
            "kh1\\music152.win32.scd",
            "kh1\\music153.win32.scd",
            "kh1\\music154.win32.scd",
            "kh1\\music155.win32.scd",
            "kh1\\music156.win32.scd",
            "kh1\\music157.win32.scd",
            "kh1\\music158.win32.scd",
            "kh1\\music159.win32.scd",
            "kh1\\music160.win32.scd",
            "kh1\\music161.win32.scd",
            "kh1\\music162.win32.scd",
            "kh1\\music163.win32.scd",
            "kh1\\music164.win32.scd",
            "kh1\\music165.win32.scd",
            "kh1\\music166.win32.scd",
            "kh1\\music167.win32.scd",
            "kh1\\music168.win32.scd",
            "kh1\\music169.win32.scd",
            "kh1\\music170.win32.scd",
            "kh1\\music171.win32.scd",
            "kh1\\music172.win32.scd",
            "kh1\\music173.win32.scd",
            "kh1\\music174.win32.scd",
            "kh1\\music175.win32.scd",
            "kh1\\music176.win32.scd",
            "kh1\\music177.win32.scd",
            "kh1\\music178.win32.scd",
            "kh1\\music179.win32.scd",
            "kh1\\music180.win32.scd",
            "kh1\\music181.win32.scd",
            "kh1\\music182.win32.scd",
            "kh1\\music183.win32.scd",
            "kh1\\music184.win32.scd",
            "kh1\\music185.win32.scd",
            "kh1\\music186.win32.scd",
            "kh1\\music187.win32.scd",
            "kh1\\music188.win32.scd",
            "kh1\\music189.win32.scd",
            "kh1\\music190.win32.scd",
            "kh1\\music191.win32.scd",
            "kh1\\music192.win32.scd",
            "kh1\\music193.win32.scd",
            "kh1\\music194.win32.scd",
            "kh1\\music196.win32.scd",
            "kh1\\music197.win32.scd",
        ]
        DMCABGM = [
            "music106.win32.scd",
            "music108.win32.scd",
            "music506.win32.scd",
            "music508.win32.scd",
            "music132.win32.scd",
        ]

        BGMList = KH2BGMList + BBSBGMList + KH1BGMList

        if option == "DMCA-Safe":
            for BGM in DMCABGM:
                BGMList.remove(BGM)

        shuffledBGM = BGMList[:]
        random.shuffle(shuffledBGM)
        BGMAssets = []
        for i in range(len(KH2BGMList)):
            BGMAssets.append({
                "name": "bgm\\{original}".format(original=KH2BGMList[i]),
                "method": "copy",
                "source": [{"name": "bgm\\{newBGM}".format(newBGM = shuffledBGM[i]), "type":"internal"}]
            })
        return BGMAssets

    def getOptions():
        return ["Disabled","All Music","DMCA-Safe"]

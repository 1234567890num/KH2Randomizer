<!DOCTYPE html>
<html lang="en">
    <head>
        <title>KH2FM Randomizer Spoiler Log</title>
    <script>
        sora_item_data = SORA_ITEM_JSON
        donald_item_data = DONALD_ITEM_JSON
        goofy_item_data = GOOFY_ITEM_JSON

    </script>


        <style>
            @font-face {
                font-family: KHMenu;
                src: url("KHMenu.otf") format("opentype");
            }
            :root {
                --background: rgba(0,214,170,.85);
            }
            *,*::before,*::after {
                box-sizing: border-box;
            }
            .content {
                height: 95hv;
                background-blend-mode: multiply;
                background-size: cover;
                display: grid;
                place-items: center;
            }
            .table_wrapper{
                height:95vh;
                overflow-y:scroll;
                overflow-x:hidden;
            }

            .styled-table {
                border-collapse: collapse;
                margin: 0px 0;
                font-size: 0.8em;
                font-family: KHMenu, sans-serif;
                min-width: 500px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
                position: relative;
            }
            .styled-table thead tr {
                background-color: #009879;
                color: #ffffff;
                text-align: center;
            }
            .styled-table th,
            .styled-table td {
                padding: 12px 15px;
            }
            .styled-table th {
                position: sticky;
                top: 0px;
                background-color: #bee3db;
            }
            .styled-table tbody tr {
                border-bottom: 1px solid #dddddd;
            }

            .styled-table tbody tr:nth-of-type(odd) {
                background-color: #f3f3f3;
            }

            .styled-table tbody tr:last-of-type {
                border-bottom: 2px solid #009879;
            }
            .styled-table tbody tr.active-row {
                font-weight: bold;
                color: #009879;
            }
            .accordion {
                background-color: #009879;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
                color: #3238e1;
                font-size: 1.8em;
                font-family: KHMenu, sans-serif;
                cursor: pointer;
                padding: 18px;
                width: 95%;
                text-align: center;
                border: none;
                outline: none;
                transition: .4s;

            }
            .active, .accordion:hover {
                background-color: #ccc;
            }
            .panel {
                padding: 0 18px;
                background-color: white;
                overflow: hidden;
                max-height: 0;
                transition: max-height 0.2s ease-out;
            }
            .accordion:after {
                content: '\02795'; /* Unicode character for "plus" sign (+) */
                font-size: 1em;
                color: #777;
                float: left;
                margin-left: 5px;
            }

            .active:after {
                content: "\2796"; /* Unicode character for "minus" sign (-) */
            }

        </style>
    </head>
    <body>
        <div class="content">
            <button class="accordion">Sora Item Placement</button>
            <div class="panel">
                <div class="table-wrapper">
                    <table class="styled-table" id="spoilerTable">
                        <tr>
                            <th>World <input type="text" id="world_search" onkeyup="tableFilter('world_search','location_search','item_search','spoilerTable')" placeholder="Search for world.."></th>
                            <th>Location <input type="text" id="location_search" onkeyup="tableFilter('world_search','location_search','item_search','spoilerTable')" placeholder="Search for location.."></th>
                            <th>Item <input type="text" id="item_search" onkeyup="tableFilter('world_search','location_search','item_search','spoilerTable')" placeholder="Search for item.."></th>
                        </tr>
                    </table>
                </div>
            </div>
            <button class="accordion">Party Item Placement</button>
            <div class="panel">
                <div class="table-wrapper">
                    <table class="styled-table" id="partyItemTable">
                        <tr>
                            <th>World <input type="text" id="party_world_search" onkeyup="tableFilter('party_world_search','party_location_search','party_item_search','partyItemTable')" placeholder="Search for world.."></th>
                            <th>Location <input type="text" id="party_location_search" onkeyup="tableFilter('party_world_search','party_location_search','party_item_search','partyItemTable')" placeholder="Search for location.."></th>
                            <th>Item <input type="text" id="party_item_search" onkeyup="tableFilter('party_world_search','party_location_search','party_item_search','partyItemTable')" placeholder="Search for item.."></th>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </body>

    <script>
        var acc = document.getElementsByClassName("accordion");
        for(var i = 0; i < acc.length; i++)
        {
            acc[i].addEventListener("click",function(){
                this.classList.toggle("active");

                var panel = this.nextElementSibling;
                if(panel.style.maxHeight){
                    panel.style.maxHeight = null;
                }
                else{
                    panel.style.maxHeight = panel.scrollHeight + "px";
                }
            });
        }


        worlds = ["Garden of Assemblage","Critical Bonuses","Space Paranoids", "Port Royal", "Twilight Town", "Olympus Coliseum", "Halloween Town", "Land of Dragons", "The World That Never Was", "Beast's Castle", "Agrabah", "Pride Lands", "Hollow Bastion", "Disney Castle / Timeless River", "Simulated Twilight Town", "Hundred Acre Wood", "Atlantica", "Puzzle"]



        function populateTable(container, data)
        {
            for(var j = 0; j < worlds.length; j++)
            {
                var world = worlds[j]
                if(world in data)
                {
                    for (var i = 0; i < data[world].length; i++)
                    {
                        var table_entry = document.createElement("tr");
                        var world_table_html = "";
                        world_table_html+="<td>"
                        world_table_html+=world
                        world_table_html+="</td>"
                        var item_data = data[world][i]
                        world_table_html+="<td>"
                        world_table_html+=item_data[0]
                        world_table_html+="</td>"
                        world_table_html+="<td>"
                        world_table_html+=item_data[1]["Name"]
                        world_table_html+="</td>"
                        table_entry.innerHTML += world_table_html;
                        container.appendChild(table_entry);
                    }
                }
            }

            if ("Level" in data)
            {
                for (var i = 0; i < data["Level"].length; i++)
                {
                    var table_entry = document.createElement("tr");
                    var world_table_html = "";
                    world_table_html+="<td>";
                    world_table_html+="Levels";
                    world_table_html+="</td>";
                    var level_data = data["Level"][i];
                    world_table_html+="<td>";
                    world_table_html+=level_data[0];
                    world_table_html+="</td>";
                    world_table_html+="<td>";
                    world_table_html+=level_data[1]["Name"];
                    world_table_html+="</td>";
                    table_entry.innerHTML += world_table_html;
                    container.appendChild(table_entry);
                }
            }

            if ("Form Levels" in data)
            {
                for (var i = 0; i < data["Form Levels"].length; i++)
                {
                    var table_entry = document.createElement("tr");
                    var world_table_html = "";
                    world_table_html+="<td>";
                    world_table_html+="Levels";
                    world_table_html+="</td>";
                    var level_data = data["Form Levels"][i]
                    world_table_html+="<td>";
                    world_table_html+=level_data[0];
                    world_table_html+="</td>";
                    world_table_html+="<td>";
                    world_table_html+=level_data[1]["Name"];
                    world_table_html+="</td>";
                    table_entry.innerHTML += world_table_html;
                    container.appendChild(table_entry);
                }
            }

            if ("Slot" in data)
            {
                for (var i = 0; i <  data["Slot"].length; i++)
                {
                    var table_entry = document.createElement("tr");
                    var world_table_html = "";
                    world_table_html+="<td>";
                    world_table_html+="Weapons";
                    world_table_html+="</td>";
                    var weapon = data["Slot"][i]
                    world_table_html+="<td>";
                    world_table_html+=weapon[0];
                    world_table_html+="</td>";
                    world_table_html+="<td>";
                    world_table_html+=weapon[1]["Name"];
                    world_table_html+="</td>";
                    table_entry.innerHTML += world_table_html;
                    container.appendChild(table_entry);
                }
            }
        }


        var mainContainer = document.getElementById("spoilerTable");
        var partyTable = document.getElementById("partyItemTable");
        populateTable(mainContainer,sora_item_data)
        populateTable(partyTable,donald_item_data)
        populateTable(partyTable,goofy_item_data)

        function tableFilter(world_elem,location_elem,item_elem,table_to_search)
        {
            var input, world_filter, location_filter, item_filter, table, tr, td1, td2, td3, i, txtValue1, txtValue2, txtValue3;
            input = document.getElementById(world_elem);
            world_filter = input.value.toUpperCase();
            input = document.getElementById(location_elem);
            location_filter = input.value.toUpperCase();
            input = document.getElementById(item_elem);
            item_filter = input.value.toUpperCase();

            table = document.getElementById(table_to_search);
            tr = table.getElementsByTagName("tr");


            for(var i=1; i<tr.length; i++)
            {
                td1 = tr[i].getElementsByTagName("td")[0];
                td2 = tr[i].getElementsByTagName("td")[1];
                td3 = tr[i].getElementsByTagName("td")[2];

                var found = false;

                txtValue1 = txtValue2 = txtValue3 = "";

                if(td1)
                {
                    txtValue1 = td1.textContent || td1.innerText;
                }
                if(td2)
                {
                    txtValue2 = td2.textContent || td2.innerText;
                }
                if(td3)
                {
                    txtValue3 = td3.textContent || td3.innerText;
                }

                if (txtValue1.toUpperCase().indexOf(world_filter) > -1 && txtValue2.toUpperCase().indexOf(location_filter) > -1 && txtValue3.toUpperCase().indexOf(item_filter) > -1)
                {
                    found = true;
                }

                if (found)
                {
                    tr[i].style.display = "";
                }
                else
                {
                    tr[i].style.display = "none";
                }

            }

        }

    </script>
</html>